machine:
  node:
    version: 6.5.0

test:
  override:
    - |
      # no test
      if [ -z "$CIRCLE_TAG" ]; then
        echo "hello"
      fi

deployment:
  release:
    tag: /^v\d+\.\d+\.\d+$/
    owner: zertosh
    commands:
      - |
        PACKAGE_VERSION="$(node -p 'require("./package.json").version')"
        echo $PACKAGE_VERSION
        echo $CIRCLE_TAG
        if [ "$CIRCLE_TAG" == "v${PACKAGE_VERSION}" ]; then
          echo "//registry.npmjs.org/:_authToken=${NPM_TOKEN}" > ~/.npmrc
          npm publish
        else
          exit 1
        fi;

experimental:
  notify:
    branches:
      only:
        - master
